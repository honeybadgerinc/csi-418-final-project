<!DOCTYPE html>
<html>

<head>
    <!--Connects to firebase-->
    <script src="https://www.gstatic.com/firebasejs/5.6.0/firebase.js"></script>
    <!-- Import and configure the Firebase SDK -->
    <!-- These scripts are made available when the app is served or deployed on Firebase Hosting -->
    <!-- If you do not serve/host your project using Firebase Hosting see https://firebase.google.com/docs/web/setup -->
    <script src="/__/firebase/5.6.0/firebase-app.js"></script>
    <script src="/__/firebase/5.6.0/firebase-auth.js"></script>
    <script src="/__/firebase/init.js"></script>
    <style>
        h1 {
            text-align: center;
        }
        h2 {
            text-align: center;
        }
        p1 {
            text-align: right;
        }
        body {
            background-image: url("images/BGImage.jpeg");
        }
        form{
            text-align: center;
        }
        div.fixed {
            position: fixed;
            width: 97%;
        }
        div.fixed1{
            position: fixed;
            width: 50%;
            bottom: 20px;
        }
        p2 {
            text-align: left;
        }
        p3 {
            text-align: left;
        }
        p4{
            font-size: 12px;
        }

        div.fixed2{
            position: fixed;
            width: 100%;
            bottom: 110px;
            
        }
        div.fixed3{
            position: fixed;
            width: 120%;
            bottom: 106px;
        }
        button{
            cursor:pointer;
        }
        table{
            font-family: helvetica;
            border-collapse: collapse;
            width: 75%;
            margin-left: 285px;
        }
        th{
            background-color: rgb(0, 125, 210);
            color: rgb(255, 255, 255);
        }
        th, td{
            padding: 5px;
            text-align: center;
            border: 1px solid;
        }
    </style>

    <!--Connects to firebase-->
    <!-- <script src="https://www.gstatic.com/firebasejs/5.6.0/firebase.js"></script> -->
</head>

<body>
    <p1>
        <div class="fixed">
            <button id="btnLogOut" onclick="signout()">Logout</button>
        </div>


        <h1>Welcome!</h1>
        <h2>Below choose to enter a stock symbol* or date to see a company's financial related articles from a company.</h2>
        <form>

            <!-- Changed to selection instead of using labels-->
            <p6>Please select either one:</p6>
            <select id="selection" onchange="myFunction()">
                <option type="radio" value="empty"> </option>
                <option type="radio" value="y">Ticker</option>
                <option type="radio" value="z">Date</option>
            </select>

            <br><input type="text" name="symbol" id="symbol" style='visibility: hidden' placeholder="AAPL, MSFT, AMZN, etc.">
            <input type="date" name="date" value="date" id="newdate" style='visibility: hidden' min="1950-01-01" max="2018-12-31">

            <br>


            <!--<input type="text" name="symbol" pattern=[A-Za-z] placeholder="AAPL, MSFT, AMZN, etc.">-->
            <br>
            &nbsp;&nbsp;<button id="btnSearch" onmouseover="object1()">Search</button>
            
            <form action="/scrape" method="GET">
                    <button value="scrape">Scrape</button>
                </form>

            <br>
            <br>
            &nbsp;&nbsp;<button onclick="document.getElementById('symbol').value="" >Clear</button>
        

        <!--for now, this is a premade table to test. will add script to make talbe once done-->
        <br><br>
        <table border="
                1" id="print">
                        <tr>
                            <th>Symbol</th>
                            <th>Headline</th>
                            <th>Date</th>
                            <th>Text</th>
                            </tr>
                        <tr>
                            </tr>
                        <tr>
                            
                    <!--Needs import locations-->
                            </tr>
                        <tr>
                            
                    <!--Needs import locations-->
                            </tr>
                        <tr>
                            
                    <!--Needs import locations-->
                            </tr>
                        <tr>
                            
                    <!--Needs import locations-->
                            </tr>
                        <tr>
                            
                    <!--Needs import locations-->
                            </tr>
                        </table>

                <!-- all the breaks are because the div was not working correctly with export button-->
                            
                <br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
                        <button onclick="exportTableToCsv('tickerarticle.csv')" id="exp" style='visibility:hidden'>Export
                    to CSV</button>
                        
                <div class="fixed3"> <button onclick="printData()" id="printtable" style="visbility:hidden"> Print
                        Table</button></div>

                <div class="fixed1">
                    <p2>
                        * - A stock symbol is an arrangement of characters (usually letters) representing a particular
                        security listed on an exchange or otherwise traded publicly. Some common examples are AAPL for
                        Apple, GOOGL for
                        Google and GE for General Electric.
                    </p2>
                </div>
                <script>
                    window.onload = function () {
                        document.getElementById('btnLogOut').addEventListener('click', signout, true);
                    };

                    function signout() {
                        //Get elements
                        const btnSignOut = document.getElementById('btnLogOut');

                        if (btnSignOut) {

                            console.log('In SignOUT');

                            //Get Email and Pass
                            const auth = firebase.auth();
                            const promise = auth.signOut();
                            promise.catch(e => alert(e.message));
                        }

                        firebase.auth().onAuthStateChanged(firebaseUser => {

                            console.log('In AuthChanged');

                            if (firebaseUser) {

                            } else {
                                window.location.href = './index.html';
                            }
                        });
                    }

                    function myFunction() {

                        var x = document.getElementById("selection").value;
                        if (x == "y") {
                            document.getElementById('symbol').style.visibility = 'visible';
                            document.getElementById('newdate').style.visibility = 'hidden';
                        }
                        else if (x == "z") {
                            document.getElementById('newdate').style.visibility = 'visible';
                            document.getElementById('symbol').style.visibility = 'hidden';
                        }
                        else {
                            document.getElementById('symbol').style.visibility = 'hidden';
                            document.getElementById('newdate').style.visibility = 'hidden';
                        }
                    }

                    function object1() {
                        document.getElementById('exp').style.visibility = "visible";
                        document.getElementById('printtable').style.visibility = "visible";
                    }

                    function downloadCsv(csv, filename) {
                        var csvFile;
                        var downloadLink;

                        csvFile = new Blob([csv], { type: "text/csv" });

                        // download link for file
                        downloadLink = document.createElement("a");

                        //filename
                        downloadLink.download = filename;

                        // link to file
                        downloadLink.href = window.URL.createObjectURL(csvFile);

                        // making sure link is not displayed
                        downloadLink.style.display = "none";

                        //linking to download/body
                        document.body.appendChild(downloadLink);

                        //onclick
                        downloadLink.click();
                    }

                    function exportTableToCsv(filename) {
                        var csv = [];
                        var rows = document.querySelectorAll("table tr");

                        for (var i = 0; i < rows.length; i++) {
                            var row = [], cols = rows[i].querySelectorAll("td, th");

                            for (var j = 0; j < cols.length; j++)
                                row.push(cols[j].innerText);

                            csv.push(row.join(","));
                        }
                        //downloads the csv file
                        downloadCsv(csv.join("\n"), filename);
                    }

                    function printData() {
                        var divToPrint = document.getElementById("print");
                        newWin = window.open("");
                        newWin.document.write(divToPrint.outerHTML);
                        newWin.print();
                        newWin.close();
                    }
                </script>

                <!------------------------------------>
</body>

</html>